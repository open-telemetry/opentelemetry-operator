apiVersion: apps/v1
kind: Deployment
metadata:
  name: controller-manager
  namespace: system
spec:
  template:
    spec:
      containers:
      - name: manager
        args:
        - "--metrics-tls-cert-file=/var/run/tls/server/tls.crt"
        - "--metrics-tls-key-file=/var/run/tls/server/tls.key"
        ports:
        - containerPort: 8443
          name: https
          protocol: TCP
        volumeMounts:
        - mountPath: /var/run/tls/server
          name: opentelemetry-operator-metrics-cert
          readOnly: true
      volumes:
      - name: opentelemetry-operator-metrics-cert
        secret:
          defaultMode: 420
          # secret generated by the 'service.beta.openshift.io/serving-cert-secret-name' annotation on the metrics-service
          secretName: opentelemetry-operator-metrics
